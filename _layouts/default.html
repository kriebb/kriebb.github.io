<!DOCTYPE html>
<html lang="en">
  <head>
    {%- include head.html -%}
  </head>
  <body>
    <header>
      <div class="navbar">
        <div class="nav-logo">
          <a href="/">
            <!-- Full Light Logo -->
            <img src="/assets/it-kriebbels-logo-full-light.svg" alt="IT KRIEBBELS" class="logo-full logo-light" />
            <!-- Full Dark Logo -->
            <img src="/assets/it-kriebbels-logo-full-dark.svg" alt="IT KRIEBBELS" class="logo-full logo-dark" />
            
            <!-- Minimal Light Logo -->
            <img src="/assets/it-kriebbels-logo-min.svg" alt="IT KRIEBBELS" class="logo-mini logo-light" />
            <!-- Minimal Dark Logo -->
            <img src="/assets/it-kriebbels-logo-min-dark.svg" alt="IT KRIEBBELS" class="logo-mini logo-dark" />
          </a>
        </div>
        {% assign active_lang = page.lang | default: site.default_lang | default: "en" %}
        {% assign t = site.data.i18n[active_lang] %}
        <div class="nav-links-container">
          <ul class="nav-links" id="nav-links">
            <li><a href="{{ '/' | relative_url }}" {% if page.url == '/' %}class="active"{% endif %}>
              {{  t.nav.home }}</a></li>
            
            <li><a href="{{ '/resume' | relative_url }}" 
                   {% if page.url contains '/resume' or page.url contains '/cv' %}class="active"{% endif %}>
              {{  t.nav.resume }}</a></li>
            
            <li><a href="{{ '/blog' | relative_url }}" {% if page.url contains '/blog' %}class="active"{% endif %}>
              {{  t.nav.blog }}</a></li>
            
            <li><a href="{{ '/contact' | relative_url }}" {% if page.url contains '/contact' %}class="active"{% endif %}>
              {{  t.nav.contact }}</a></li>
            
            <li><a href="{{ '/about' | relative_url }}" 
                   {% if page.url contains '/about' or page.url contains '/over-mij' %}class="active"{% endif %}>
              {{  t.nav.about }}</a></li>
          </ul>
        </div>
        
        <div class="nav-actions">
          <!-- Language Switcher -->
          {% include language-switcher.html %}          
          <!-- Theme Toggle Buttons -->
          <button id="darkModeToggle" class="dark-mode-btn" hidden aria-label="Toggle dark mode">
            <i class="fas fa-moon"></i>
          </button>
          <button id="lightModeToggle" class="light-mode-btn" hidden aria-label="Toggle light mode">
            <i class="fas fa-sun"></i>
          </button>
        </div>
        
        <!-- Nav toggle should be separate from the other elements -->
        <button class="nav-toggle" aria-label="Toggle navigation" type="button">â˜°</button>
      </div>
    </header>

    <div class="layout-container">
      {% if page.sidebar %}
        {%- include sidebar.html -%}
      {% endif %}
      <main class="main-content">
        {{ content }}
      </main>
    </div>

    <footer>
      {%- include footer.html -%}
    </footer>

    <script>
        // Inject site route data from _data/routes.yml
          window.siteRoutes = {
            {% for route_pair in site.data.routes.routes %}
              {{ route_pair[0] }}: {
                {% for lang_route in route_pair[1] %}
                  {{ lang_route[0] }}: "{{ lang_route[1] }}",
                {% endfor %}
              },
            {% endfor %}
          };

           /**
   * Gets the translated route for the current page
   * @param {string} currentPath - Current page path
   * @param {string} targetLang - Target language code
   * @return {string} The translated path
   */
  window.getTranslatedRoute = function(currentPath, targetLang) {
    // Strip trailing slash
    const cleanPath = currentPath.replace(/\/$/, '');
    
    // Default to home page if we can't determine current page
    if (!cleanPath || cleanPath === '') {
      return targetLang === 'en' ? '/' : '/nl/';
    }
    
    // Try to find current route in site routes
    let currentLang = 'en';
    let currentRoute = null;
    
    // Check if we're on a Dutch page
    if (cleanPath.startsWith('/nl/')) {
      currentLang = 'nl';
    }
    
    // If already on target language, no need to change
    if (currentLang === targetLang) {
      return currentPath;
    }
    
    // Find which route we're currently on
    for (const [routeKey, routeObj] of Object.entries(window.siteRoutes)) {
      if (cleanPath === routeObj[currentLang].replace(/\/$/, '')) {
        currentRoute = routeKey;
        break;
      }
    }
    
    // If we found a match, return the translated route
    if (currentRoute && window.siteRoutes[currentRoute][targetLang]) {
      return window.siteRoutes[currentRoute][targetLang];
    }
    
    // Fallback to home page if no match found
    return targetLang === 'en' ? '/' : '/nl/';
  };
})();
    </script>
    <!-- Scripts -->
    <script src="{{ '/assets/js/theme.js' | relative_url }}?v={{ site.time | date: '%s' }}" defer></script>
    <script src="{{ '/assets/js/navigation.js' | relative_url }}?v={{ site.time | date: '%s' }}" defer></script>
    <script src="{{ '/assets/js/main.js' | relative_url }}?v={{ site.time | date: '%s' }}" defer></script>
    
    <!-- Defer non-critical scripts -->
    <script src="https://unpkg.com/swiper@9.2.4/swiper-bundle.min.js" crossorigin="anonymous" defer></script>
    <script src="https://unpkg.com/aos@3.0.0-beta.6/dist/aos.js" defer></script>   
    {% include cookie-consent.html %}
  </body>
</html>